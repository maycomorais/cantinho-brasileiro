<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Painel Administrativo - Cantinho Brasileiro</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="admin.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <base target="_blank">
</head>
  <body>
    <audio id="som-campainha" preload="auto" loop>
      <source src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" type="audio/mpeg" />
      <source src="https://freesound.org/data/previews/320/320655_5260872-lq.mp3" type="audio/mpeg" />
    </audio>

    <div class="sidebar">
      <div class="brand">CANTINHO ADMIN</div>

      <div
        style="padding: 10px; text-align: center; font-size: 0.8rem; background: rgba(0, 0, 0, 0.2)"
      >
        <i class="fas fa-user-circle"></i> <span id="user-cargo">...</span><br />
        <small id="user-email">...</small>
      </div>

      <div class="menu">
        <div class="menu-item active" onclick="showTab('dashboard', event)">
          <i class="fas fa-chart-line"></i><span class="mobile-hide"> Vis√£o</span>
        </div>

        <div class="menu-item" onclick="showTab('pdv', event)" style="color: #ffca28">
          <i class="fas fa-cash-register"></i><span class="mobile-hide"> PDV Balc√£o</span>
        </div>

        <div class="menu-item" onclick="showTab('pedidos', event)">
          <i class="fas fa-clipboard-list"></i><span class="mobile-hide"> Pedidos</span>
        </div>

        <div class="menu-item" onclick="showTab('cozinha', event)">
          <i class="fas fa-fire"></i><span class="mobile-hide"> Cozinha</span>
        </div>

        <div class="menu-item restrito-gerente" onclick="showTab('equipe', event)">
          <i class="fas fa-users"></i><span class="mobile-hide"> Equipe</span>
        </div>

        <div class="menu-item" onclick="showTab('produtos', event)">
            <i class="fas fa-utensils"></i><span> Prod.</span>
        </div>

        <div class="menu-item" onclick="showTab('categorias', event)">
            <i class="fas fa-tags"></i><span> Cats</span>
        </div>
        
        <div class="menu-item" onclick="showTab('motoboys', event)">
            <i class="fas fa-motorcycle"></i><span> Motos</span>
        </div>

        <div class="menu-item restrito-gerente" onclick="showTab('financeiro', event)">
          <i class="fas fa-wallet"></i><span class="mobile-hide"> Financeiro</span>
        </div>
        <div class="menu-item restrito-func" onclick="showTab('configuracoes', event)">
          <i class="fas fa-cogs"></i><span class="mobile-hide"> Config</span>
        </div>
      </div>

      <div class="menu-item" onclick="logout()" style="margin-top: auto; background: #c0392b">
        <i class="fas fa-sign-out-alt"></i><span class="mobile-hide "> Sair</span>
      </div>
    </div>

    <div class="main-content">
      <div id="dashboard" class="tab-content active">
        <div class="dash-header">
          <div class="dash-title">
            <span class="dash-greeting" id="dash-greeting">Bom dia</span>
            <h2>Painel de Controle</h2>
          </div>
          <div class="dash-date" id="dash-date"></div>
        </div>

        <div class="kpi-grid dash-kpi-grid">
          <div class="kpi-card kpi-accent-green">
            <div class="kpi-icon"><i class="fas fa-coins"></i></div>
            <div class="kpi-info">
              <div class="kpi-label">Vendas Hoje</div>
              <div class="value" id="kpi-vendas">Gs 0</div>
            </div>
          </div>
          <div class="kpi-card kpi-accent-blue">
            <div class="kpi-icon"><i class="fas fa-receipt"></i></div>
            <div class="kpi-info">
              <div class="kpi-label">Pedidos Hoje</div>
              <div class="value" id="kpi-pedidos">0</div>
            </div>
          </div>
          <div class="kpi-card kpi-accent-orange">
            <div class="kpi-icon"><i class="fas fa-motorcycle"></i></div>
            <div class="kpi-info">
              <div class="kpi-label">A Pagar Motoboys</div>
              <div class="value" id="kpi-moto">Gs 0</div>
            </div>
          </div>
          <div class="kpi-card kpi-accent-red">
            <div class="kpi-icon"><i class="fas fa-fire-alt"></i></div>
            <div class="kpi-info">
              <div class="kpi-label">Em Preparo</div>
              <div class="value" id="kpi-em-preparo">0</div>
            </div>
          </div>
        </div>

        <div class="dash-rankings">
          <div class="card ranking-card">
            <div class="ranking-header">
              <i class="fas fa-trophy" style="color:#f59e0b"></i>
              <h3>Top Produtos</h3>
              <select id="rank-prod-periodo" class="rank-periodo-select" onchange="carregarRankingProdutos()" style="margin-left:auto">
                <option value="hoje">Hoje</option>
                <option value="7">7 dias</option>
                <option value="30">30 dias</option>
                <option value="mes">Este m√™s</option>
                <option value="custom">Per√≠odo</option>
              </select>
            </div>
            <div id="rank-prod-custom" style="display:none;gap:4px;align-items:center;margin-bottom:8px;flex-wrap:wrap">
              <input type="date" id="rank-prod-inicio" class="rank-data-input">
              <span style="font-size:0.75rem;color:#888">at√©</span>
              <input type="date" id="rank-prod-fim" class="rank-data-input">
              <button class="btn btn-sm btn-primary" onclick="carregarRankingProdutos()" style="padding:3px 10px;font-size:0.75rem">Ir</button>
            </div>
            <div id="ranking-produtos-list" class="ranking-list"></div>
          </div>
          <div class="card ranking-card">
            <div class="ranking-header">
              <i class="fas fa-star" style="color:#a78bfa"></i>
              <h3>Clientes Ass√≠duos</h3>
              <select id="rank-cli-periodo" class="rank-periodo-select" onchange="carregarRankingClientes()" style="margin-left:auto">
                <option value="tudo">Todos</option>
                <option value="hoje">Hoje</option>
                <option value="7">7 dias</option>
                <option value="30">30 dias</option>
                <option value="mes">Este m√™s</option>
                <option value="custom">Per√≠odo</option>
              </select>
            </div>
            <div id="rank-cli-custom" style="display:none;gap:4px;align-items:center;margin-bottom:8px;flex-wrap:wrap">
              <input type="date" id="rank-cli-inicio" class="rank-data-input">
              <span style="font-size:0.75rem;color:#888">at√©</span>
              <input type="date" id="rank-cli-fim" class="rank-data-input">
              <button class="btn btn-sm btn-primary" onclick="carregarRankingClientes()" style="padding:3px 10px;font-size:0.75rem">Ir</button>
            </div>
            <div id="ranking-clientes-list" class="ranking-list"></div>
          </div>
        </div>

        <!-- legado para JS existente -->
        <table id="tabela-ranking" style="display:none"><tbody></tbody></table>
      </div>

      <div id="pedidos" class="tab-content">
        <div class="section-topbar">
          <h2 class="section-title">Pedidos</h2>
          <div style="display:flex; gap:8px; align-items:center;">
            <button class="btn btn-relatorio" onclick="abrirRelatorio()" title="Relat√≥rio Detalhado">
              <i class="fas fa-clipboard-list"></i><span class="mobile-hide"> Relat√≥rio</span>
            </button>
            <button class="btn btn-primary btn-icon btn-refresh" onclick="carregarPedidos()" title="Atualizar">
              <i class="fas fa-sync-alt"></i>
            </button>
          </div>
        </div>

        <div class="card rota-card">
          <div class="rota-card-title"><i class="fas fa-route"></i> Despachar Rota</div>
          <div class="rota-controls">
            <select id="sel-motoboy" class="form-control">
              <option value="">Selecione Motoboy...</option>
            </select>
            <button class="btn btn-success btn-zap" onclick="enviarRotaZap()">
              <i class="fab fa-whatsapp"></i> Enviar Rota
            </button>
          </div>
        </div>

        <div class="pedidos-list" id="lista-pedidos-cards"></div>

        <!-- Tabela legado (oculta no mobile, vis√≠vel desktop) -->
        <div class="card pedidos-table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th width="50">Rota</th>
                <th>ID</th>
                <th>Cliente</th>
                <th>Status</th>
                <th>Total</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="lista-pedidos"></tbody>
          </table>
        </div>
      </div>

      <div id="cozinha" class="tab-content">
        <h2 class="section-title">Monitor de Cozinha (KDS)</h2>
        <div class="cozinha-grid" id="grid-cozinha"></div>
      </div>

      <div id="pdv" class="tab-content">
        <h2 class="section-title">üè™ Venda Balc√£o (PDV)</h2>

        <div class="pdv-tabs" id="pdv-tabs" style="display:none">
          <button class="pdv-tab-btn active" onclick="pdvMudarAba('carrinho',this)">üõí Pedido</button>
          <button class="pdv-tab-btn" onclick="pdvMudarAba('produtos',this)">üç£ Card√°pio</button>
          <button class="pdv-tab-btn" onclick="pdvMudarAba('monitor',this)">üìã Mesas</button>
        </div>

        <div class="pdv-container">
          <div class="pdv-carrinho pdv-tab-active">
            <h4 class="pdv-carrinho-titulo">üõí Novo Pedido</h4>

            <div class="pdv-form-row">
              <div class="pdv-mesa-col">
                <label class="pdv-label">Mesa <span class="obrig">*</span></label>
                <input type="number" id="balcao-mesa" class="form-control" placeholder="N¬∫" min="1" required />
              </div>
              <div class="pdv-cliente-col">
                <label class="pdv-label">Cliente</label>
                <input type="text" id="balcao-cliente" class="form-control" placeholder="Nome do cliente" />
              </div>
            </div>
            <div class="pdv-tel-row">
              <label class="pdv-label">Telefone (WhatsApp)</label>
              <input type="tel" id="balcao-telefone" class="form-control" placeholder="Ex: 0981234567" />
            </div>

            <div class="pdv-lista-itens" id="pdv-lista"></div>

            <div class="pdv-total-box">
              <div class="pdv-total-row">
                <span>Total:</span>
                <span>Gs <span id="balcao-total">0</span></span>
              </div>
              <select id="balcao-pag" class="form-control" class="pdv-select-pag"
                onchange="atualizarInfoPagPDV(parseInt(document.getElementById('balcao-total').innerText.replace(/\D/g,'')))">
                <option value="Efetivo">Efetivo</option>
                <option value="Cartao">Cart√£o</option>
                <option value="Pix">Pix</option>
                <option value="Transferencia">Transfer√™ncia</option>
              </select>
              <div id="balcao-pag-info" style="display:none; background:#e8f5e9; border:1px solid #4caf50; border-radius:6px; padding:8px 12px; font-size:0.9rem; color:#1b5e20; margin-bottom:8px"></div>
              <button class="btn btn-success" class="btn-lancar-cozinha" onclick="salvarPedidoBalcao()">
                üöÄ LAN√áAR NA COZINHA
              </button>
            </div>
          </div>

          <div class="pdv-produtos">
          <div class="pdv-mesas-bar" id="pdv-mesas-bar">
            <span class="pdv-mesas-label"><i class="fas fa-chair"></i> Mesas:</span>
            <span class="mesa-monitor-vazio" id="pdv-mesas-vazio">Nenhuma mesa ativa</span>
          </div>
          <div id="pdv-grid"></div>
        </div>

          <div class="pdv-monitor">
            <h4 class="pdv-monitor-titulo"><i class="fas fa-utensils"></i> Pedidos em Andamento</h4>
            <div id="lista-mesas-andamento">
              <p style="text-align: center; font-size: 0.8rem; color: #aaa; margin-top: 20px">Nenhum pedido ativo.</p>
            </div>
          </div>
        </div>
      </div>

      <div id="financeiro" class="tab-content">
  <h2 class="section-title">üí∞ Controle Financeiro</h2>

  <!-- ===== FILTROS ===== -->
  <div class="filtro-bar">
    <div class="filtro-group">
      <label><i class="far fa-calendar-alt"></i> In√≠cio</label>
      <input type="date" id="fin-inicio" />
    </div>

    <div class="filtro-group">
      <label><i class="far fa-calendar-alt"></i> Fim</label>
      <input type="date" id="fin-fim" />
    </div>

    <div class="filtro-group">
      <label><i class="fas fa-wallet"></i> Pagamento</label>
      <select id="fin-tipo">
        <option value="todos">Todos</option>
        <option value="Efetivo">Dinheiro</option>
        <option value="Cartao">Cart√£o</option>
        <option value="Pix">Pix</option>
        <option value="Transferencia">Transfer√™ncia</option>
      </select>
    </div>

    <!-- NOVO FILTRO -->
    <div class="filtro-group">
      <label><i class="fas fa-receipt"></i> Factura</label>
      <select id="fin-factura">
        <option value="todos">Todos</option>
        <option value="com_factura">Com Factura</option>
        <option value="sem_factura">Sem Factura</option>
      </select>
    </div>

    <button class="btn-filtrar" onclick="calcularFinanceiro()">
      <i class="fas fa-filter"></i> Filtrar
    </button>

    <!-- NOVO BOT√ÉO EXPORTAR -->
    <button class="btn btn-success" onclick="exportarFinanceiro()" style="height: 45px;">
      <i class="fas fa-file-excel"></i> Excel
    </button>
    <button class="btn btn-primary" onclick="abrirGraficos()" style="height:45px; background:#8e44ad; border-color:#8e44ad">
      <i class="fas fa-chart-bar"></i> Gr√°ficos
    </button>
  </div>

  <!-- ===== CONTROLE DE CAIXA ===== -->
  <div class="card" style="margin-bottom: 20px; padding: 20px; border: none; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);">
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px">
      <div style="width: 4px; height: 20px; background: var(--primary); border-radius: 2px"></div>
      <h3 style="margin: 0; color: #444">Controle de Caixa</h3>
    </div>

    <div class="actions-grid">
      <button class="action-card ac-abrir" onclick="abrirModalCaixa('abertura')">
        <i class="fas fa-door-open"></i>
        <span>Abrir Caixa</span>
      </button>

      <button class="action-card ac-suprir" onclick="abrirModalCaixa('suprimento')">
        <i class="fas fa-plus-circle"></i>
        <span>Suprimento</span>
      </button>

      <button class="action-card ac-sangria" onclick="abrirModalCaixa('sangria')">
        <i class="fas fa-hand-holding-usd"></i>
        <span>Sangria</span>
      </button>

      <button class="action-card ac-despesa" onclick="abrirModalCaixa('despesa')">
        <i class="fas fa-file-invoice-dollar"></i>
        <span>Despesa</span>
      </button>

      <button class="action-card ac-fechar" onclick="fecharCaixaResumo()">
        <i class="fas fa-calculator"></i>
        <span>Fechar Dia</span>
      </button>
    </div>
  </div>

  <!-- ===== KPIs PRINCIPAIS ===== -->
  <div class="kpi-grid">
    <div class="kpi-card">
      <h3>Faturamento</h3>
      <div class="value" id="card-faturamento">Gs 0</div>
    </div>
    <div class="kpi-card">
      <h3>Custo Entregas</h3>
      <div class="value" id="card-custo-moto">Gs 0</div>
    </div>
    <div class="kpi-card">
      <h3>Lucro Operacional</h3>
      <div class="value" id="card-lucro" style="color: green">Gs 0</div>
    </div>
    
    <!-- NOVOS CARDS -->
    <div class="kpi-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
      <h3 style="color: rgba(255,255,255,0.9);">Total Pedidos</h3>
      <div class="value" id="card-qtd-pedidos" style="color: white;">0</div>
    </div>
    <div class="kpi-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
      <h3 style="color: rgba(255,255,255,0.9);">Ticket M√©dio</h3>
      <div class="value" id="card-ticket-medio" style="color: white;">Gs 0</div>
    </div>
  </div>

  <!-- ===== FORMAS DE PAGAMENTO ===== -->
  <div class="card" style="margin-top: 20px; padding: 20px;">
    <h3 style="margin-bottom: 15px; color: #555;">üí≥ Por Forma de Pagamento</h3>
    <div class="kpi-grid" style="margin: 0;">
      <div class="kpi-card" style="background: #fff3cd; border-left: 4px solid #ffc107;">
        <h4 style="color: #856404;">Dinheiro</h4>
        <div class="value" id="total-efetivo" style="color: #856404;">Gs 0</div>
      </div>
      <div class="kpi-card" style="background: #d1ecf1; border-left: 4px solid #17a2b8;">
        <h4 style="color: #0c5460;">Cart√£o</h4>
        <div class="value" id="total-cartao" style="color: #0c5460;">Gs 0</div>
      </div>
      <div class="kpi-card" style="background: #d4edda; border-left: 4px solid #28a745;">
        <h4 style="color: #155724;">Pix</h4>
        <div class="value" id="total-pix" style="color: #155724;">Gs 0</div>
      </div>
      <div class="kpi-card" style="background: #e7e8ea; border-left: 4px solid #6c757d;">
        <h4 style="color: #383d41;">Transfer√™ncia</h4>
        <div class="value" id="total-transf" style="color: #383d41;">Gs 0</div>
      </div>
    </div>
  </div>

  <!-- ===== TABELA MOTOBOYS ===== -->
  <div class="card" style="margin-top: 20px">
    <h3>üèçÔ∏è Relat√≥rio Motoboys</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Qtd Entregas</th>
          <th>Taxa Unit√°ria</th>
          <th>Total a Pagar</th>
        </tr>
      </thead>
      <tbody id="lista-financeiro-motoboys"></tbody>
    </table>
  </div>
</div>

      <div id="equipe" class="tab-content">
        <h2 class="section-title">Gest√£o de Equipe</h2>
        <div class="card">
          <div style="margin-bottom: 20px">
            <h4 style="margin-bottom:12px">Cadastrar Usu√°rio</h4>
            <div class="equipe-form">
              <input type="email" id="novo-user-email" placeholder="Email" class="form-control" />
              <input type="text" id="novo-user-senha" placeholder="Senha (m√≠n. 6)" class="form-control" />
              <select id="novo-user-cargo" class="form-control">
                <option value="funcionario">Funcion√°rio</option>
                <option value="gerente">Gerente</option>
              </select>
              <button class="btn btn-success" onclick="cadastrarUsuario()">
                <i class="fas fa-user-plus"></i> Criar
              </button>
            </div>
          </div>
          <div class="table-container">
            <table class="table">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>Cargo</th>
                  <th>Data</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="lista-equipe"></tbody>
            </table>
          </div>
        </div>
      </div>

<div id="produtos" class="tab-content">
  
  <div class="header-title" style="flex-direction: column; align-items: flex-start; gap: 15px;">
    <h2>Gest√£o de Estoque e Equipe</h2>
  </div>

  <div id="lista-produtos-wrapper" class="subtab-content">
      <div class="produtos-header">
          <h3>Produtos</h3>
          <div class="produtos-header-actions">
            <input type="text" id="busca-produto" class="form-control" placeholder="üîç Buscar produto..." oninput="filtrarProdutos(this.value)">
            <button class="btn btn-primary" onclick="toggleNovosProdutosTipos()"><i class="fas fa-plus"></i> Novo Produto</button>
          </div>
      </div>

      <!-- SELETOR DE TIPO ‚Äî aparece ao clicar em "+ Novo Produto" -->
      <div id="novo-produto-tipos" class="novo-produto-tipos" style="display:none">
        <div class="novo-produto-tipos-titulo">Escolha o tipo de produto</div>
        <div class="novo-produto-tipos-grid">
          <button class="tipo-btn" onclick="criarNovoProduto('padrao')"><i class="fas fa-tag"></i><span>Simples</span><small>Produto sem op√ß√µes</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('bebida')"><i class="fas fa-wine-bottle"></i><span>Bebida</span><small>Refri, √°gua, suco</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('lanche')"><i class="fas fa-burger"></i><span>Lanche</span><small>Burger, hot dog</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('pizza')"><i class="fas fa-pizza-slice"></i><span>Pizza</span><small>Tamanhos & sabores</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('acai')"><i class="fas fa-leaf"></i><span>A√ßa√≠</span><small>Etapas de montagem</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('shake')"><i class="fas fa-blender"></i><span>Shake</span><small>Milk shake</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('suco')"><i class="fas fa-lemon"></i><span>Suco</span><small>Frutas & adicionais</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('sorvete')"><i class="fas fa-ice-cream"></i><span>Sorvete</span><small>Sabores, a√ßa√≠</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('montavel')"><i class="fas fa-layer-group"></i><span>Mont√°vel</span><small>Poke, salada</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('combo')"><i class="fas fa-star"></i><span>Combo</span><small>Kit / promo√ß√£o</small></button>
          <button class="tipo-btn" onclick="criarNovoProduto('variacoes')" style="border-color:#8b5cf6"><i class="fas fa-palette" style="color:#8b5cf6"></i><span>Varia√ß√µes</span><small>Sabores c/ pre√ßo</small></button>
        </div>
      </div>

      <div id="lista-produtos-grid" class="produtos-grid">
        <!-- Cards gerados pelo JS -->
      </div>
  </div>

  <div id="lista-categorias-wrapper" class="subtab-content subtab-hidden">
      <div class="cat-section-header">
        <div>
          <h3 class="cat-section-title">üè∑Ô∏è Categorias do Card√°pio</h3>
          <p class="cat-section-subtitle">Gerencie a organiza√ß√£o e hor√°rios de exibi√ß√£o</p>
        </div>
        <button class="btn btn-primary cat-btn-nova" onclick="abrirModalCategoria()">
          <i class="fas fa-plus"></i> Nova Categoria
        </button>
      </div>

      <!-- Grid de cards ‚Äî preenchido pelo JS -->
      <div id="lista-categorias" class="cat-grid"></div>

      <!-- Painel de Subcategorias (abre ao clicar em "Sub" em algum card) -->
      <div id="lista-subcategorias-wrapper" style="margin-top:24px; display:none;"></div>
  </div>

  <div id="lista-motos-wrapper" class="subtab-content subtab-hidden">
      <div style="display: flex; justify-content: space-between; margin: 15px 0;">
          <h3>Equipe Motoboys</h3>
          <button class="btn btn-primary" onclick="abrirModalMoto()">Novo Motoboy</button>
      </div>
      <div class="table-container">
          <table>
              <thead><tr><th>Nome</th><th>Telefone</th><th>A√ß√µes</th></tr></thead>
              <tbody id="lista-motos"></tbody>
          </table>
      </div>
  </div>
</div>

      <!-- ===== ABA CONFIGURA√á√ïES (COMPLETA) ===== -->
      <div id="configuracoes" class="tab-content">
        <h2 class="section-title">‚öôÔ∏è Configura√ß√µes</h2>

        <div class="card cfg-card">
          <div class="cfg-section-title"><i class="fas fa-store"></i> Loja &amp; Configura√ß√µes Gerais</div>
          <div class="cfg-grid">
            <div class="form-group">
              <label>Status Manual</label>
              <select id="cfg-aberta" class="form-control">
                <option value="true">üü¢ Seguir hor√°rio semanal</option>
                <option value="false">üî¥ For√ßar fechado</option>
              </select>
            </div>
            <div class="form-group">
              <label>Cota√ß√£o Real (Gs/R$)</label>
              <input type="number" id="cfg-cotacao" class="form-control" placeholder="Ex: 1100">
            </div>
          </div>

          <!-- GRADE SEMANAL -->
          <div style="margin-top:16px">
            <div style="font-weight:700;font-size:0.95rem;color:#2c3e50;margin-bottom:10px">
              üìÖ Hor√°rios por dia da semana
              <small style="font-weight:400;color:#999;display:block;margin-top:2px">Cada dia pode ter at√© 2 turnos (ex: almo√ßo + jantar). Deixe em branco para fechar o dia inteiro.</small>
            </div>
            <div id="grade-semanal" class="grade-semanal">
              <!-- Gerado pelo JS -->
            </div>
          </div>

          <button class="btn btn-primary" onclick="salvarConfiguracoes()" style="margin-top:16px">
            <i class="fas fa-save"></i> Salvar Configura√ß√µes
          </button>
        </div>

        <div class="card cfg-card" style="margin-top:16px">
          <div class="cfg-section-title"><i class="fas fa-tags"></i> Promo√ß√£o do Dia (Banner)</div>
          <p style="font-size:0.83rem;color:#888;margin-bottom:12px">
            Ao clicar no banner, o cliente j√° abre o modal do produto para comprar.
          </p>
          <div class="form-group">
            <label>ID do Produto Promocional</label>
            <input type="text" id="cfg-banner-id" class="form-control" placeholder="Ex: 42">
          </div>
          <div class="form-group" style="margin-top:10px">
            <label>Foto do Banner <span class="obrig">*</span></label>
            <input type="file" id="cfg-banner-file" class="form-control" accept="image/*" onchange="previewBanner(this)">
          </div>
          <div id="cfg-banner-preview-box" style="display:none;margin:10px 0;text-align:center">
            <img id="cfg-banner-preview" src="" style="max-height:130px;border-radius:8px;border:1px solid #ddd">
          </div>
          <input type="hidden" id="cfg-banner-img">
          <button class="btn btn-success" onclick="salvarBanner()" style="margin-top:10px;width:100%">
            <i class="fas fa-upload"></i> Enviar Foto &amp; Ativar Promo√ß√£o
          </button>
        </div>

        <!-- DEPOIS DA SE√á√ÉO DE PERSONALIZA√á√ÉO VISUAL -->
<div id="card-cupons-cfg" class="card cfg-card" style="margin-top:16px">
    <div class="cfg-section-title">
        <i class="fas fa-ticket-alt"></i> Gest√£o de Cupons de Desconto
    </div>
    
    <button class="btn btn-primary" onclick="abrirModalCupom()" style="margin-bottom:15px">
        <i class="fas fa-plus"></i> Novo Cupom
    </button>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>C√≥digo</th>
                    <th>Tipo</th>
                    <th>Valor</th>
                    <th>M√≠nimo</th>
                    <th>Usos / Limite</th>
                    <th>Validade</th>
                    <th>Status</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="lista-cupons">
                <!-- Preenchido via JS -->
            </tbody>
        </table>
    </div>
</div>

<!-- MODAL DE CUPOM -->
<div class="modal-overlay" id="modal-cupom">
    <div class="modal-card-modern">
        <div class="modal-header-modern">
            <h3><i class="fas fa-ticket-alt"></i> Gerenciar Cupom</h3>
            <button class="close-btn-modern" onclick="fecharModal('modal-cupom')">√ó</button>
        </div>
        
        <div class="modal-body-modern">
            <input type="hidden" id="cupom-id">
            
            <div class="form-group-modern">
                <label><i class="fas fa-tag"></i> C√≥digo do Cupom</label>
                <input type="text" id="cupom-codigo" class="input-modern" 
                       placeholder="Ex: BEMVINDO10" style="text-transform:uppercase">
            </div>
            
            <div class="form-group-modern">
                <label><i class="fas fa-percentage"></i> Tipo de Desconto</label>
                <select id="cupom-tipo" class="input-modern" onchange="alterarTipoCupom()">
                    <option value="percentual">Desconto Percentual (%)</option>
                    <option value="frete">Frete Gr√°tis</option>
                </select>
            </div>
            
            <div class="form-group-modern" id="box-valor-cupom">
                <label><i class="fas fa-percent"></i> Valor do Desconto (%)</label>
                <input type="number" id="cupom-valor" class="input-modern" 
                       placeholder="Ex: 10" min="0" max="100">
            </div>
            
            <div class="form-group-modern">
                <label><i class="fas fa-money-bill"></i> Valor M√≠nimo do Pedido (Gs)</label>
                <input type="number" id="cupom-minimo" class="input-modern" 
                       placeholder="Ex: 50000" min="0">
            </div>
            
            <!-- Limitador de uso -->
            <div class="form-group-modern">
                <label><i class="fas fa-users"></i> Limite de Usos <small style="color:#888;font-weight:normal">(0 = ilimitado)</small></label>
                <input type="number" id="cupom-limite" class="input-modern"
                       placeholder="Ex: 20" min="0">
            </div>

            <!-- Validade -->
            <div class="form-group-modern">
                <label><i class="fas fa-calendar-alt"></i> Validade <small style="color:#888;font-weight:normal">(opcional)</small></label>
                <input type="date" id="cupom-validade" class="input-modern">
            </div>

            <div class="checkbox-modern">
                <input type="checkbox" id="cupom-ativo" checked>
                <label for="cupom-ativo">
                    <strong>Cupom Ativo</strong><br>
                    <small>Desmarque para desativar temporariamente</small>
                </label>
            </div>
        </div>
        
        <div class="modal-footer-modern">
            <button class="btn-modern btn-modern-cancel" onclick="fecharModal('modal-cupom')">
                <i class="fas fa-times"></i> Cancelar
            </button>
            <button class="btn-modern btn-modern-primary" onclick="salvarCupom()">
                <i class="fas fa-save"></i> Salvar Cupom
            </button>
        </div>
    </div>
</div>

        <div class="card cfg-card" style="margin-top:16px">
          <div class="cfg-section-title"><i class="fas fa-palette"></i> Personaliza√ß√£o Visual</div>
          <div class="cfg-grid">
            <div class="form-group">
              <label>Nome da Loja</label>
              <input type="text" id="cfg-nome-loja" class="form-control" placeholder="Ex: Cantinho Brasileiro">
            </div>
            <div class="form-group">
              <label>Cor Principal (bot√µes)</label>
              <div style="display:flex;gap:8px;align-items:center">
                <input type="color" id="cfg-cor-primaria" value="#1a7a2e" style="width:50px;height:40px;border:none;cursor:pointer;border-radius:4px">
                <input type="text" id="cfg-cor-primaria-hex" class="form-control" placeholder="#1a7a2e" style="flex:1">
              </div>
            </div>
            <div class="form-group">
              <label>√çcone da Loja (upload)</label>
              <input type="file" id="cfg-icone-file" class="form-control" accept="image/*" onchange="previewIcone(this)">
            </div>
            <div class="form-group" id="cfg-icone-preview-box" style="display:none">
              <label>Preview</label>
              <img id="cfg-icone-preview" src="" style="width:60px;height:60px;object-fit:cover;border-radius:50%;border:2px solid #ddd">
            </div>
          </div>
          <button class="btn btn-primary" onclick="salvarPersonalizacao()" style="margin-top:12px">
            <i class="fas fa-paint-brush"></i> Salvar Personaliza√ß√£o
          </button>
        </div>
      </div>

    </div><!-- /main-content -->


    <div id="modal-produto" class="modal-overlay">
      <div class="modal-content modal-produto-content">
        <div class="modal-produto-header">
          <h3>Gerenciar Produto</h3>
          <button class="btn-modal-fechar" onclick="fecharModal('modal-produto')" aria-label="Fechar">√ó</button>
        </div>
        <input type="hidden" id="prod-id" />

        <!-- DADOS B√ÅSICOS -->
        <div class="form-group">
          <label>Nome</label>
          <input type="text" id="prod-nome" class="form-control" />
        </div>
        <div class="form-group">
          <label>Descri√ß√£o</label>
          <textarea id="prod-desc" class="form-control" rows="2"></textarea>
        </div>
        <div class="form-group" style="display: flex; gap: 10px">
          <div style="flex: 1">
            <label>Pre√ßo base (Gs) <small style="color:#888">‚Äî para Pizza, √© o m√≠nimo (tamanho P)</small></label>
            <input type="number" id="prod-preco" class="form-control" />
          </div>
          <div style="flex: 1">
            <label>Categoria</label>
            <select id="prod-cat" class="form-control" onchange="onCatChange()"></select>
          </div>
        </div>
        <div class="form-group" id="box-subcategoria" style="display:none">
          <label>Subcategoria <small style="color:#888">(opcional)</small></label>
          <select id="prod-subcat" class="form-control"></select>
        </div>
        <div class="form-group">
          <label>Imagem (Upload ou URL)</label>
          <input type="file" id="prod-img-file" class="form-control" onchange="previewUpload(this)" />
          <input type="text" id="prod-img" class="form-control" placeholder="Ou cole a URL aqui" />
          <div id="box-preview" style="display:none; margin-top:10px; text-align:center">
            <img id="img-preview" src="" style="max-height:100px; border-radius:5px" />
          </div>
        </div>
        <div class="form-group" style="display:flex; align-items:center; gap:10px; background:#fff8e1; padding:10px; border-radius:8px;">
          <input type="checkbox" id="prod-somente-balcao" style="width:20px; height:20px;">
          <label for="prod-somente-balcao" style="font-weight:bold; cursor:pointer;">
            üè™ Somente Balc√£o (PDV)
            <small style="display:block; font-weight:normal; color:#888;">N√£o aparece no card√°pio online</small>
          </label>
        </div>

        <hr class="modal-divisor"/>

        <!-- TIPO DE PRODUTO ‚Äî badge compacto (edit√°vel apenas ao editar produto existente) -->
        <div id="modal-tipo-badge-wrapper" class="modal-tipo-badge-wrapper">
          <span class="modal-tipo-label">Tipo:</span>
          <div id="modal-tipo-badge" class="modal-tipo-badge">üì¶ Simples</div>
          <button type="button" class="btn-alterar-tipo" id="btn-alterar-tipo" onclick="toggleAlterarTipo()">‚úèÔ∏è Alterar tipo</button>
        </div>
        <!-- Grid de tipos (vis√≠vel ao clicar "Alterar tipo" no modo edi√ß√£o) -->
        <div id="builder-type-grid-wrapper" style="display:none">
          <div class="builder-type-grid" id="builder-type-grid">
            <button type="button" class="builder-type-btn active" data-tipo="padrao" onclick="selecionarTipoBuilder('padrao')">
              <i class="fas fa-tag"></i><strong>Simples</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="bebida" onclick="selecionarTipoBuilder('bebida')">
              <i class="fas fa-wine-bottle"></i><strong>Bebida</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="lanche" onclick="selecionarTipoBuilder('lanche')">
              <i class="fas fa-burger"></i><strong>Lanche</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="pizza" onclick="selecionarTipoBuilder('pizza')">
              <i class="fas fa-pizza-slice"></i><strong>Pizza</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="acai" onclick="selecionarTipoBuilder('acai')">
              <i class="fas fa-leaf"></i><strong>A√ßa√≠</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="shake" onclick="selecionarTipoBuilder('shake')">
              <i class="fas fa-blender"></i><strong>Shake</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="suco" onclick="selecionarTipoBuilder('suco')">
              <i class="fas fa-lemon"></i><strong>Suco</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="sorvete" onclick="selecionarTipoBuilder('sorvete')">
              <i class="fas fa-ice-cream"></i><strong>Sorvete</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="montavel" onclick="selecionarTipoBuilder('montavel')">
              <i class="fas fa-layer-group"></i><strong>Mont√°vel</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="combo" onclick="selecionarTipoBuilder('combo')">
              <i class="fas fa-star"></i><strong>Combo</strong>
            </button>
            <button type="button" class="builder-type-btn" data-tipo="variacoes" onclick="selecionarTipoBuilder('variacoes')">
              <i class="fas fa-palette"></i><strong>Varia√ß√µes</strong>
            </button>
          </div>
        </div>
        <div id="builder-tipo-hint" style="display:none"></div>
        <div id="builder-lanche-hint" style="display:none;background:#e0f2fe;border-left:4px solid #0284c7;border-radius:6px;padding:10px 14px;font-size:0.82rem;color:#0c4a6e;margin-top:8px;">
          üçî Use a se√ß√£o <strong>"Adicionais (Extras)"</strong> para ingredientes opcionais.
        </div>
        <input type="hidden" id="prod-tipo-builder" value="padrao">

        <!-- ‚îÄ‚îÄ BUILDER: VARIA√á√ïES DE SABOR ‚îÄ‚îÄ -->
        <div id="builder-variacoes" class="builder-section" style="display:none">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
            <h4 style="color:#8b5cf6;margin:0">üé® Varia√ß√µes de Sabor</h4>
            <button class="btn btn-sm" style="background:#8b5cf6;color:#fff" onclick="addVariacao()">+ Adicionar Varia√ß√£o</button>
          </div>
          <div style="background:#f5f3ff;border:1px solid #ddd6fe;border-radius:8px;padding:10px 14px;font-size:0.81rem;color:#5b21b6;margin-bottom:12px">
            üéØ Cada varia√ß√£o tem nome, pre√ßo pr√≥prio e foto opcional (herda a foto do produto por padr√£o).<br>
            O menu mostrar√° <strong>"A partir de Gs X"</strong> com o menor pre√ßo.
          </div>
          <div id="variacoes-lista" style="display:flex;flex-direction:column;gap:10px"></div>
        </div>

        <!-- ‚îÄ‚îÄ BUILDER: MONT√ÅVEL (Poke/Salada) ‚îÄ‚îÄ -->
        <div id="builder-montavel" class="builder-section" style="display:none">
          <h4 style="color:#e67e22">ü•ó Etapas de Montagem</h4>
          <p style="font-size:0.82rem; color:#888; margin-bottom:10px">Configure as etapas que o cliente vai escolher (ingredientes, bases, molhos, etc.)</p>
          <div id="builder-steps"></div>
          <button class="btn btn-sm btn-info" onclick="addBuilderStep()">+ Adicionar Etapa</button>
          <!-- mant√©m compatibilidade com toggleBuilder() -->
          <input type="hidden" id="prod-montavel" value="false">
        </div>

        <!-- ‚îÄ‚îÄ BUILDER: PIZZA ‚îÄ‚îÄ -->
        <div id="builder-pizza" class="builder-section" style="display:none">
          <h4 style="color:#e74c3c">üçï Configura√ß√£o da Pizza</h4>

          <div class="pizza-config-grid">
            <div class="form-group">
              <label>M√°x. de sabores por pizza</label>
              <select id="pizza-max-sabores" class="form-control">
                <option value="1">1 sabor</option>
                <option value="2" selected>2 sabores</option>
                <option value="3">3 sabores</option>
                <option value="4">4 sabores</option>
              </select>
            </div>
            <div class="form-group">
              <label>Tipos de massa oferecidos</label>
              <div style="display:flex; gap:12px; margin-top:6px; flex-wrap:wrap">
                <label style="cursor:pointer"><input type="checkbox" id="pizza-tipo-salgada" checked> Salgada</label>
                <label style="cursor:pointer"><input type="checkbox" id="pizza-tipo-doce"> Doce</label>
              </div>
            </div>
            <div class="form-group">
              <label>Bordas recheadas?</label>
              <div style="display:flex; gap:12px; margin-top:6px">
                <label style="cursor:pointer"><input type="checkbox" id="pizza-tem-borda" onchange="toggleBordaPreco()"> Sim, oferecer bordas</label>
              </div>
            </div>
          </div>

          <!-- Bordas Recheadas ‚Äî lista com nome + pre√ßo -->
          <div id="pizza-borda-preco-box" style="display:none; margin-top:14px">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
              <h5 style="margin:0">üßÄ Bordas dispon√≠veis</h5>
              <button class="btn btn-sm btn-success" onclick="addPizzaBorda()">+ Borda</button>
            </div>
            <div style="background:#fff8e1; border-radius:8px; padding:8px 12px; font-size:0.78rem; color:#7d5a00; margin-bottom:8px">
              üí° Adicione cada tipo de borda com seu pre√ßo. Ex: Cheddar ‚Üí Gs 8.000 | Catupiry ‚Üí Gs 9.000 | Chocolate ‚Üí Gs 10.000
            </div>
            <div id="pizza-bordas-lista"></div>
          </div>

          <!-- Tamanhos -->
          <div style="margin-top:16px">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
              <h5 style="margin:0">Tamanhos dispon√≠veis</h5>
              <button class="btn btn-sm btn-success" onclick="addPizzaTamanho()">+ Adicionar Tamanho</button>
            </div>
            <div style="background:#fff3f3; border-radius:8px; padding:10px; margin-bottom:8px; font-size:0.78rem; color:#888">
              üí° Preencha: Nome, Fatias, Di√¢metro (cm) e o pre√ßo por categoria (Tradicional, Especial, Doce) + o valor da borda para cada tamanho.
            </div>
            <div id="pizza-tamanhos-lista">
              <!-- Tamanhos gerados pelo JS -->
            </div>
          </div>

          <!-- Sabores cadastrados -->
          <div style="margin-top:16px">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
              <h5 style="margin:0">Sabores cadastrados <small style="color:#888; font-weight:normal">(o cliente escolhe deste menu)</small></h5>
              <button class="btn btn-sm btn-success" onclick="addPizzaSabor()">+ Sabor</button>
            </div>
            <div id="pizza-sabores-lista" style="max-height:220px; overflow-y:auto; border:1px solid #eee; border-radius:8px; padding:8px">
              <p style="color:#aaa; font-size:0.82rem; text-align:center; margin:10px 0">Clique em "+ Sabor" para adicionar</p>
            </div>
          </div>
        </div>

        <hr class="modal-divisor"/>

        <!-- ‚îÄ‚îÄ EXTRAS (ADICIONAIS) ‚Äî Para todos os tipos ‚îÄ‚îÄ -->
        <div class="form-group" style="background:#f0f9ff; border:1px solid #bee3f8; border-radius:10px; padding:12px">
          <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:8px">
            <label style="font-weight:700; margin:0">
              ‚ûï Adicionais (Extras opcionais)
              <small style="display:block; font-weight:normal; color:#888">O cliente poder√° marcar estes itens ao pedir</small>
            </label>
            <div style="display:flex; align-items:center; gap:8px">
              <input type="checkbox" id="prod-tem-extras" style="width:18px;height:18px" onchange="toggleExtras()">
              <label for="prod-tem-extras" style="cursor:pointer; font-size:0.9rem">Ativar extras</label>
            </div>
          </div>
          <div id="extras-area" style="display:none">
            <div id="extras-lista"></div>
            <button class="btn btn-sm btn-info" onclick="addExtra()" style="margin-top:8px">+ Adicionar Extra</button>
          </div>
        </div>

        <div class="modal-actions" style="margin-top:16px">
          <button class="btn btn-primary" onclick="salvarProduto()">Salvar Produto</button>
          <button class="btn btn-secondary" onclick="fecharModal('modal-produto')">Cancelar</button>
        </div>
      </div>
    </div>

    <div id="modal-cat" class="modal-overlay">
      <div class="modal-content" style="max-width: 420px">
        <h3 id="titulo-modal-cat">Categoria</h3>
        <input type="hidden" id="cat-modo-edicao" />
        <div class="form-group">
          <label>Nome Exibi√ß√£o</label>
          <input type="text" id="cat-nome" class="form-control" oninput="autoSlugFromNome()" />
        </div>
        <div class="form-group">
          <label>Slug (ID √∫nico, sem espa√ßos) <small style="color:#e67e22" id="aviso-slug-edicao" style="display:none">‚ö†Ô∏è Alterar atualiza todos os produtos</small></label>
          <input type="text" id="cat-slug" class="form-control" />
        </div>
        <div class="form-group">
          <label>Ordem</label>
          <input type="number" id="cat-ordem" class="form-control" />
        </div>
        <hr style="margin:12px 0; border-color:#eee">
        <div style="background:#f0f8ff; border:1px solid #b3d9ff; border-radius:8px; padding:12px; margin-bottom:12px">
          <div style="font-weight:600; font-size:0.9rem; color:#1a6eb5; margin-bottom:8px">
            üïê Hor√°rio de Exibi√ß√£o <small style="font-weight:400; color:#666">(opcional ‚Äî deixe em branco para exibir sempre)</small>
          </div>
          <div style="display:flex; gap:12px; align-items:center">
            <div style="flex:1">
              <label style="font-size:0.82rem; color:#555">Das</label>
              <input type="time" id="cat-hora-inicio" class="form-control" />
            </div>
            <div style="flex:1">
              <label style="font-size:0.82rem; color:#555">At√©</label>
              <input type="time" id="cat-hora-fim" class="form-control" />
            </div>
          </div>
          <small style="color:#888; display:block; margin-top:6px">Ex: almo√ßo das 11:00 √†s 14:30. Fora desse hor√°rio, a categoria fica oculta no card√°pio.</small>
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="salvarCategoria()">Salvar</button>
          <button class="btn btn-secondary" onclick="fecharModal('modal-cat')">Cancelar</button>
        </div>
      </div>
    </div>

    <div id="modal-moto" class="modal-overlay">
      <div class="modal-content" style="max-width: 400px">
        <h3>Motoboy</h3>
        <input type="hidden" id="moto-id" />
        <div class="form-group">
          <label>Nome</label>
          <input type="text" id="moto-nome" class="form-control" />
        </div>
        <div class="form-group">
          <label>Telefone (WhatsApp)</label>
          <input type="text" id="moto-tel" class="form-control" />
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="salvarMotoboy()">Salvar</button>
          <button class="btn btn-secondary" onclick="fecharModal('modal-moto')">Cancelar</button>
        </div>
      </div>
    </div>

    <!-- ===== MODAL CAIXA (faltava no HTML) ===== -->
    <div id="modal-caixa" class="modal-overlay" style="display:none">
      <div class="modal-content" style="max-width:420px">
        <h3 id="titulo-caixa">Opera√ß√£o de Caixa</h3>
        <input type="hidden" id="tipo-caixa" value="">
        <div class="form-group">
          <label>Valor (Gs)</label>
          <input type="number" id="valor-caixa" class="form-control" placeholder="Ex: 50000" min="1">
        </div>
        <div class="form-group">
          <label>Descri√ß√£o</label>
          <input type="text" id="desc-caixa" class="form-control" placeholder="Ex: Pagamento fornecedor">
        </div>
        <div class="modal-actions">
          <button class="btn btn-secondary" onclick="fecharModal('modal-caixa')">Cancelar</button>
          <button class="btn btn-primary" onclick="salvarMovimentacaoCaixa()">
            <i class="fas fa-save"></i> Salvar
          </button>
        </div>
      </div>
    </div>

    <!-- MODAL RELAT√ìRIO DETALHADO DE PEDIDOS -->
<div id="modal-relatorio" class="modal-overlay" style="display:none; align-items:flex-start; padding:10px; overflow-y:auto;">
  <div class="modal-content" style="max-width:95vw; width:100%; margin:auto; max-height:90vh; overflow-y:auto;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; position:sticky; top:0; background:white; padding:8px 0; z-index:10; border-bottom:1px solid #eee;">
      <h3 style="margin:0"><i class="fas fa-clipboard-list" style="color:#3498db"></i> Relat√≥rio de Pedidos</h3>
      <button onclick="fecharModal('modal-relatorio')" style="background:#e74c3c;color:white;border:none;border-radius:50%;width:32px;height:32px;font-size:1.1rem;cursor:pointer">√ó</button>
    </div>
    
    <!-- Filtros -->
    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:16px; background:#f8f9fa; padding:12px; border-radius:8px;">
      <div class="form-group" style="margin:0; flex:0 0 auto;">
        <label style="font-size:0.8rem;font-weight:600">N¬∫ do Pedido</label>
        <input type="number" id="rel-filtro-numero" class="form-control" placeholder="Ex: 91" style="width:120px;" oninput="this.value ? (document.getElementById('rel-filtro-inicio').disabled=true, document.getElementById('rel-filtro-fim').disabled=true) : (document.getElementById('rel-filtro-inicio').disabled=false, document.getElementById('rel-filtro-fim').disabled=false)">
      </div>
      <div class="form-group" style="margin:0; flex:0 0 auto;">
        <label style="font-size:0.8rem;font-weight:600">De</label>
        <input type="date" id="rel-filtro-inicio" class="form-control">
      </div>
      <div class="form-group" style="margin:0; flex:0 0 auto;">
        <label style="font-size:0.8rem;font-weight:600">At√©</label>
        <input type="date" id="rel-filtro-fim" class="form-control">
      </div>
      <div class="form-group" style="margin:0; display:flex; align-items:flex-end;">
        <button class="btn btn-primary" onclick="carregarRelatorio()"><i class="fas fa-search"></i> Filtrar</button>
      </div>
      <div style="display:flex; align-items:flex-end; margin-left:auto;">
        <span id="rel-total-count" style="font-size:0.85rem;color:#666;"></span>
      </div>
    </div>

    <!-- Tabela -->
    <div class="table-container" style="overflow-x:auto;">
      <table style="width:100%; border-collapse:collapse; font-size:0.82rem;">
        <thead style="background:#2c3e50;color:white;">
          <tr>
            <th style="padding:8px;text-align:left">#ID</th>
            <th style="padding:8px;text-align:left">Data/Hora</th>
            <th style="padding:8px;text-align:left">Cliente</th>
            <th style="padding:8px;text-align:left">Itens</th>
            <th style="padding:8px;text-align:left">Status</th>
            <th style="padding:8px;text-align:left">Total</th>
            <th style="padding:8px;text-align:left">Tempos</th>
          </tr>
        </thead>
        <tbody id="rel-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

    <script src="supabaseClient.js"></script>
    <script src="admin.js"></script>
  
    <!-- ===== MODAL GR√ÅFICOS ===== -->
<div id="modal-graficos" class="modal-overlay" style="display:none; align-items:flex-start; padding:20px; overflow-y:auto">
  <div class="modal-content" style="max-width:720px; width:100%; margin:auto">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px">
      <h3 style="margin:0"><i class="fas fa-chart-bar" style="color:#8e44ad"></i> An√°lise Comparativa de Vendas</h3>
      <button onclick="fecharModal('modal-graficos')" style="background:none;border:none;font-size:1.5rem;cursor:pointer;color:#888">‚úï</button>
    </div>

    <!-- Seletores de per√≠odo -->
    <div style="display:flex; gap:8px; margin-bottom:16px; flex-wrap:wrap">
      <button class="btn btn-periodo btn-sm" data-dias="7"  onclick="carregarDadosGrafico('7')"  style="background:#8e44ad;color:#fff;padding:6px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem">7 dias</button>
      <button class="btn btn-periodo btn-sm" data-dias="14" onclick="carregarDadosGrafico('14')" style="background:#bdc3c7;color:#333;padding:6px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem">14 dias</button>
      <button class="btn btn-periodo btn-sm" data-dias="30" onclick="carregarDadosGrafico('30')" style="background:#bdc3c7;color:#333;padding:6px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem">30 dias</button>
    </div>

    <!-- Cards de resumo -->
    <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-bottom:16px">
      <div style="background:#f0f9f4; border-radius:10px; padding:12px; border-left:4px solid #27ae60">
        <div style="font-size:0.75rem; color:#888; font-weight:600">TOTAL DO PER√çODO</div>
        <div id="graf-total-periodo" style="font-size:1.1rem; font-weight:700; color:#27ae60">-</div>
      </div>
      <div style="background:#f0f4ff; border-radius:10px; padding:12px; border-left:4px solid #3498db">
        <div style="font-size:0.75rem; color:#888; font-weight:600">M√âDIA POR DIA</div>
        <div id="graf-media-dia" style="font-size:1.1rem; font-weight:700; color:#3498db">-</div>
      </div>
      <div style="background:#f0fff4; border-radius:10px; padding:12px; border-left:4px solid #2ecc71">
        <div style="font-size:0.75rem; color:#888; font-weight:600">üèÜ MELHOR DIA</div>
        <div id="graf-melhor-dia" style="font-size:0.9rem; font-weight:700; color:#27ae60">-</div>
      </div>
      <div style="background:#fff5f5; border-radius:10px; padding:12px; border-left:4px solid #e74c3c">
        <div style="font-size:0.75rem; color:#888; font-weight:600">üìâ PIOR DIA</div>
        <div id="graf-pior-dia" style="font-size:0.9rem; font-weight:700; color:#e74c3c">-</div>
      </div>
    </div>

    <!-- Gr√°fico de barras -->
    <div style="position:relative; height:280px; background:#fafafa; border-radius:10px; padding:10px">
      <canvas id="canvas-grafico"></canvas>
    </div>

    <p style="font-size:0.75rem; color:#aaa; margin-top:10px; text-align:center">
      üü¢ Melhor dia &nbsp;|&nbsp; üî¥ Pior dia &nbsp;|&nbsp; üîµ Demais dias
    </p>
  </div>
</div>

</body>
</html>